‡πÑ‡∏î‡πâ ‡∏ï‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå 3 ‡πÄ‡∏•‡∏¢ üëá (‡∏£‡∏ß‡∏° **Master + Preparation** ‡πÑ‡∏ß‡πâ‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô)

---

# üìÑ FILE 3: `tables_master_preparation.md`

```md
# Master + Preparation Tables (MySQL)

DB: MySQL  
‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ‡∏£‡∏ß‡∏°:
- Master (M*) = dimension ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏õ‡∏•‡∏ä‡∏∑‡πà‡∏≠/‡πÉ‡∏ä‡πâ group/filter
- Preparation = ‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£/‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏

---

# PART A) MASTER TABLES (Dimensions)

## A1) m_province ‚Äî ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î
PK:
- id

Fields:
- province_name
- province_id (external/alt id)

Used by:

- b100_disaster_area.province_id
- c102_request_for_relief.province_id
- SPS01/02/03: m01_* ‡∏´‡∏£‡∏∑‡∏≠ province_id (‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏ï‡πà table)
- Preparation tables: province_id

---

## A2) m_amphur ‚Äî ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠
PK:
- id

FK:
- province_id ‚Üí m_province.id

Fields:
- amphur_name

Used by:
- b100_disaster_area.amphur_id
- c102_request_for_relief.amphur_id
- Preparation tables: amphur_id

---

## A3) m_tambon ‚Äî ‡∏ï‡∏≥‡∏ö‡∏•
PK:
- id

FK:
- amphur_id ‚Üí m_amphur.id

Fields:
- tambon_name

Used by:
- b100_disaster_area.tambon_id
- c102_request_for_relief.tambon_id
- Preparation tables: tambon_id

---

## A4) m_village ‚Äî ‡∏´‡∏°‡∏π‡πà‡∏ö‡πâ‡∏≤‡∏ô
PK:
- id

FK:
- tambon_id ‚Üí m_tambon.id

Fields:
- village_name
- moo (‡πÄ‡∏•‡∏Ç‡∏´‡∏°‡∏π‡πà)

Used by:
- b100_disaster_area.village_id
- c102_request_for_relief.village_id
- (‡∏ö‡∏≤‡∏á preparation ‡πÉ‡∏ä‡πâ moo_id: ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏•‡∏≠‡∏á join moo_id = m_village.id)

Fallback:
- ‡∏ñ‡πâ‡∏≤ moo_id join ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ field relation `moo_name` ‡πÅ‡∏ó‡∏ô

---

## A5) m_disaster_type ‚Äî ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏†‡∏±‡∏¢‡∏û‡∏¥‡∏ö‡∏±‡∏ï‡∏¥
PK:
- id

Fields:
- disaster_type
- status

Used by:
- b100_disaster_area.disaster_type_id
- centering_command.disaster_type_id

---

## A6) m_animal_type ‚Äî ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏±‡∏ï‡∏ß‡πå (M05)
PK:
- id

Fields:
- animal_type
- help_quota (‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö)
- unit

Used by:
- b31_damage_count.animal_type_id
- b22_move_animal.animal_type_id
- b40_help_quata_area.m05_b40_id
- b41_assis_rate_area.m05_b41_id

---

## A7) m_anima_sub_type ‚Äî ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏¢‡πà‡∏≠‡∏¢‡∏™‡∏±‡∏ï‡∏ß‡πå (M09)
PK:
- id

FK:
- animal_type_id ‚Üí m_animal_type.id

Fields:
- animal_sub_type
- age_range
- help_rate (‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö)

Used by:
- b41_assis_rate_area.m09_b41_id

---

## A8) m_feed_type ‚Äî ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏™‡∏±‡∏ï‡∏ß‡πå
PK:
- id

Fields:
- feed_type

Used by:
- b21_feed_count.feed_type_id

---

## A9) m_healthcare_type ‚Äî ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏™‡∏±‡∏ï‡∏ß‡πå
PK:
- id

Fields:
- healthcare_type

Used by:
- b23_healthcare_count.healthcare_type_id

---

## A10) m_status ‚Äî ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏•‡∏≤‡∏á
PK:
- id (‡πÑ‡∏≠‡∏î‡∏µ‡πÅ‡∏ó‡πâ)

Fields:
- status_id (‡πÑ‡∏≠‡∏î‡∏µ‡πÄ‡∏ó‡∏µ‡∏¢‡∏°)
- status_name
- status_color
- status_group

Join rule:
1) transaction.status_id = m_status.id
2) fallback: transaction.status_id = m_status.status_id

---

# PART B) PREPARATION TABLES (Resource Readiness)

> ‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ filter ‡∏ö‡πà‡∏≠‡∏¢:
- year_report = :year
- round_report = :round
- province_id / amphur_id / tambon_id

---

## B1) animal_pen ‚Äî ‡∏Ñ‡∏≠‡∏Å‡∏™‡∏±‡∏ï‡∏ß‡πå/‡πÅ‡∏ú‡∏á + ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏±‡∏ï‡∏ß‡πå
PK:
- id

FK (location):
- province_id ‚Üí m_province.id
- amphur_id ‚Üí m_amphur.id
- tambon_id ‚Üí m_tambon.id

Other keys:
- animal_pen_id
- migrated_animal_id (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ä‡∏±‡∏î‡∏ß‡πà‡∏≤‡∏ä‡∏µ‡πâ‡πÑ‡∏õ master ‡πÑ‡∏´‡∏ô)
- report_schedule_items_id ‚Üí BD161 (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ä‡∏∏‡∏î)

Measures:
- num_panel (‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ú‡∏á)
- animal_type_amount (‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏±‡∏ï‡∏ß‡πå)

Relations:
- hasMany ‚Üí possession_animal_type (BD101)
- hasMany ‚Üí group_animal_type (BD121)

Operational:
- year_report
- round_report
- report_status

---

## B2) centering_command ‚Äî ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏®‡∏π‡∏ô‡∏¢‡πå/‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á (‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö)
PK:
- id

FK:
- province_id ‚Üí m_province.id
- disaster_type_id ‚Üí m_disaster_type.id

Time:
- start_date
- end_date
- doc_date_expire
- year

Attachments:
- file_command (belongsToMany attachment)

Operational:
- status
- report_cycle

---

## B3) emergency_kit ‚Äî ‡∏ñ‡∏∏‡∏á‡∏¢‡∏±‡∏á‡∏ä‡∏µ‡∏û/‡∏ä‡∏∏‡∏î‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô
PK:
- id

FK:
- province_id ‚Üí m_province.id
- report_schedule_items_id ‚Üí BD161

Fields:
- receive_location

Measures:
- num_bag_1 (‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÉ‡∏´‡∏ç‡πà)
- num_bag_2 (‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏õ‡∏µ‡∏Å)
- num_bag_3 (‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á)
- f_v05zvzumm0m (‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ñ‡∏∏‡∏á‡∏£‡∏ß‡∏°/field code)

Operational:
- year_report
- round_report
- status

---

## B4) grass_supply ‚Äî ‡∏Ñ‡∏•‡∏±‡∏á‡πÄ‡∏™‡∏ö‡∏µ‡∏¢‡∏á/‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏™‡∏±‡∏ï‡∏ß‡πå (inventory)
PK:
- id

FK (location):
- province_id ‚Üí m_province.id
- amphur_id ‚Üí m_amphur.id
- tambon_id ‚Üí m_tambon.id

Other keys:
- affiliated_id (master ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ä‡∏∏‡∏î)
- livestock_id (master ‡πÄ‡∏Ç‡∏ï/‡∏´‡∏ô‡πà‡∏ß‡∏¢ ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ä‡∏∏‡∏î)

Fields:
- warehouse_name
- feed_name
- last_updated_at

Measures:
- quantity

Operational:
- year_report
- round_report

---

## B5) migration_area ‚Äî ‡∏à‡∏∏‡∏î/‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏û‡∏¢‡∏û‡∏™‡∏±‡∏ï‡∏ß‡πå (‡∏°‡∏µ‡∏û‡∏¥‡∏Å‡∏±‡∏î)
PK:
- id

FK (location):
- province_id ‚Üí m_province.id
- amphur_id ‚Üí m_amphur.id
- tambon_id ‚Üí m_tambon.id
- moo_id (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏•‡∏≠‡∏á join moo_id = m_village.id)

Other keys:
- migrated_animal_id (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ä‡∏±‡∏î)
- migration_area_id (‡∏£‡∏´‡∏±‡∏™‡∏à‡∏∏‡∏î)
- report_schedule_items_id ‚Üí BD161

Geo:
- coordinates_xy (string)
- location (point)

Measures:
- amount (‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ï‡∏±‡∏ß)
- area_rai (‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏£‡πà)
- amount_animal_type (‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏±‡∏ï‡∏ß‡πå)

Relations:
- hasMany ‚Üí possession_animal_type (BD101)
- hasMany ‚Üí log_migration_area_fk (BD102)

Operational:
- year_report
- round_report
- status_report
- remark
- flg_master

Fallback:
- ‡∏ñ‡πâ‡∏≤ moo_id join ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ `moo_name` relation object ‡πÅ‡∏ó‡∏ô
- ‡∏ñ‡πâ‡∏≤ migrated_animal_id ‡πÑ‡∏°‡πà‡∏ä‡∏±‡∏î ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ `animal_type_name` relation object ‡πÅ‡∏ó‡∏ô

---

## B6) vehicle ‚Äî ‡∏£‡∏ñ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à/‡∏≠‡∏û‡∏¢‡∏û
PK:
- id

FK:
- province_id ‚Üí m_province.id
- amphur_id ‚Üí m_amphur.id
- livestock_zone_id (master ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ä‡∏∏‡∏î)
- livestock_id (master ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ä‡∏∏‡∏î)
- report_schedule_items_id ‚Üí BD161
- agency (belongsTo m2o) master ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ä‡∏∏‡∏î
- livestock_district (belongsTo m2o) master ‡πÄ‡∏Ç‡∏ï ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ä‡∏∏‡∏î

Fields:
- registration_number
- driver_name
- driver_phone
- provin_coordinator_name
- provin_coordinator_phone
- type_car

Measures:
- num_car
- weight_capacity_tons

Operational:
- year_report
- round_report
- status_report

---

## B7) veterinary_unit ‚Äî ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏™‡∏±‡∏ï‡∏ß‡πÅ‡∏û‡∏ó‡∏¢‡πå/‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡∏ô
PK:
- id

FK (location):
- province_id ‚Üí m_province.id
- amphur_id ‚Üí m_amphur.id
- tambon_id ‚Üí m_tambon.id
- moo_id (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏•‡∏≠‡∏á join moo_id = m_village.id)

Other keys:
- report_schedule_id (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ä‡∏∏‡∏î)
- report_schedule_items_id ‚Üí BD161

Fields:
- veterinary_unit_name
- danger_level

Measures:
- num_people
- unit_team

Relations:
- hasMany ‚Üí people_doc (‡∏´‡∏°‡∏≠)

Operational:
- year_report
- round_report
- status

---

# QUICK SQL SNIPPETS (MySQL)

## 1) Preparation: filter ‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô
WHERE year_report = :year
  AND round_report = :round

## 2) Join ‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà
LEFT JOIN m_province p ON t.province_id = p.id
LEFT JOIN m_amphur  a ON t.amphur_id   = a.id
LEFT JOIN m_tambon  tb ON t.tambon_id  = tb.id

## 3) moo_id fallback
-- try
LEFT JOIN m_village v ON t.moo_id = v.id
-- if not match: use relation object moo_name (depends on implementation)

---

END OF MASTER + PREPARATION TABLES
```

---

‡∏ñ‡∏±‡∏î‡πÑ‡∏õ‡∏ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏¢‡∏≤‡∏Å ‚Äú‡πÄ‡∏™‡∏£‡∏¥‡∏°‡πÉ‡∏´‡πâ LLM ‡πÇ‡∏Ñ‡∏ï‡∏£‡πÅ‡∏°‡πà‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‚Äù ‡∏ú‡∏°‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ó‡∏≥‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏≠‡∏µ‡∏Å‡∏≠‡∏±‡∏ô (optional) ‡∏ä‡∏∑‡πà‡∏≠ `query_playbook.md` ‡∏ó‡∏µ‡πà‡∏£‡∏ß‡∏° 10-15 query patterns (top-N, drilldown, compare transaction vs SPS, ‡∏Ø‡∏•‡∏Ø) ‚Äî ‡∏ñ‡πâ‡∏≤‡∏à‡∏∞‡πÄ‡∏≠‡∏≤ ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ß‡πà‡∏≤ ‚Äú‡πÄ‡∏≠‡∏≤ playbook ‡∏î‡πâ‡∏ß‡∏¢‚Äù ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢.
