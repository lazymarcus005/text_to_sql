‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ù‡∏±‡πà‡∏á **Transaction Module** ‡πÅ‡∏ö‡∏ö compact ‡πÅ‡∏ï‡πà‡∏Ñ‡∏£‡∏ö + ‡∏ä‡∏µ‡πâ join ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç

---

# üìÑ FILE 2: `tables_transaction.md`

```md
# Transaction Tables (Core Business Flow)

DB: MySQL  
‡πÇ‡∏°‡∏î‡∏π‡∏•‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ò‡∏∏‡∏£‡∏Å‡∏£‡∏£‡∏°‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö (‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏ ‚Üí ‡∏Ç‡∏≠‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠ ‚Üí ‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠ ‚Üí ‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô)

---

# 1Ô∏è‚É£ b000_open_disaster (B00) ‚Äî ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡πÄ‡∏Ç‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏†‡∏±‡∏¢

Primary Key:
- id

Fields ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:
- name
- start_at
- end_at
- status_id

Relations:
- hasMany ‚Üí b100_disaster_area
- hasMany ‚Üí c102_request_for_relief
- hasMany ‚Üí tbl_sps01 / tbl_sps02_round_report / tbl_sps03_round_report

‡πÉ‡∏ä‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠:
- ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏∞‡∏î‡∏±‡∏ö ‚Äú‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‚Äù
- Filter ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Å‡∏¥‡∏î‡∏†‡∏±‡∏¢

---

# 2Ô∏è‚É£ b100_disaster_area (B10) ‚Äî ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏†‡∏±‡∏¢

Primary Key:
- id

Foreign Keys:
- province_id
- amphur_id
- tambon_id
- village_id
- disaster_type_id
- open_disaster_ids (‚Üí B00)

Fields:
- annonced_date
- end_annonced
- status_id
- sps1_status_id
- sps2_status_id
- sps3_status_id

Relations:
- belongsTo ‚Üí m_province / m_amphur / m_tambon / m_village
- hasMany ‚Üí c10_request_for_relief
- hasMany ‚Üí b10ex01
- hasMany ‚Üí b20_init_help
- hasMany ‚Üí b30_init_damage

‡πÉ‡∏ä‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠:
- ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà
- Drilldown ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î/‡∏≠‡∏≥‡πÄ‡∏†‡∏≠/‡∏ï‡∏≥‡∏ö‡∏•

---

# 3Ô∏è‚É£ b10ex01 ‚Äî ‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£ + ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏±‡∏ï‡∏ß‡πå

Primary Key:
- id

FK:
- b10_id (‚Üí B10)

Fields:
- farmer_name
- farmer_pid
- farm_province_id
- l_11000000 ‡∏ñ‡∏∂‡∏á l_20000000 (‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó)

‡πÉ‡∏ä‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠:
- ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÉ‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà
- ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ï‡πà‡∏≠‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£

---

# 4Ô∏è‚É£ b20_init_help ‚Äî ‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô

Primary Key:
- id

FK:
- disaster_area_id (‚Üí B10)
- farmer_id (‚Üí EX01)

Measures:
- total_feed_count
- total_move_animal_count
- total_healthcare_count
- total_relief_bags

Relations:
- hasMany ‚Üí b21_feed_count
- hasMany ‚Üí b22_move_animal
- hasMany ‚Üí b23_healthcare_count

‡πÉ‡∏ä‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠:
- ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Å‡∏≤‡∏£‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏à‡∏£‡∏¥‡∏á (‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏£‡∏∏‡∏õ)

---

## 4.1 b21_feed_count
- feed_type_id ‚Üí m_feed_type
- amount

## 4.2 b22_move_animal
- animal_type_id ‚Üí m_animal_type
- amount

## 4.3 b23_healthcare_count
- healthcare_type_id ‚Üí m_healthcare_type
- amount

---

# 5Ô∏è‚É£ b30_init_damage ‚Äî ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô

Primary Key:
- id

FK:
- disaster_area_id (‚Üí B10)
- farmer_id

Measures:
- total_damage
- total_animal

Relations:
- hasMany ‚Üí b31_damage_count

---

## 5.1 b31_damage_count
- animal_type_id ‚Üí m_animal_type
- amount

‡πÉ‡∏ä‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠:
- ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢‡πÅ‡∏¢‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏±‡∏ï‡∏ß‡πå

---

# 6Ô∏è‚É£ c10_request_for_relief ‚Äî ‡∏Ñ‡∏≥‡∏Ç‡∏≠ ‡∏Å‡∏©.01

Primary Key:
- id

FK:
- b00_open_disaster_id
- b10_disaster_area_id
- farmer_id

Fields:
- start_date
- end_date
- approved_at
- approved_status
- value_assis_amount
- government_budget
- permanent_secretary_budget

Relations:
- hasMany ‚Üí b40_help_quata_area
- hasMany ‚Üí b41_assis_rate_area

---

# 7Ô∏è‚É£ c102_request_for_relief ‚Äî ‡∏Ñ‡∏≥‡∏Ç‡∏≠ ‡∏Å‡∏©.02 ‡∏´‡∏°‡∏π‡πà‡∏ö‡πâ‡∏≤‡∏ô

Primary Key:
- id

FK:
- province_id
- amphur_id
- tambon_id
- village_id
- b10_disaster_area_id
- b00_open_disaster_id
- c10_id

Fields:
- approved_at
- approved_status

---

# 8Ô∏è‚É£ SPS REPORT TABLES

## 8.1 tbl_sps01 (‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏±‡∏ï‡∏ß‡πå)
- total_*
- help_*
- grand_total
- grand_help_total
- total_animals
- total_farmers

‡πÉ‡∏ä‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠:
- ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏¢‡∏≠‡∏î‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£

---

## 8.2 tbl_sps02 (‡∏™‡∏£‡∏∏‡∏õ‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏´‡∏ô‡πâ‡∏≤)
- total_*
- feed_1 / feed_2
- health_1 / health_2
- total_relief_bags

‡πÉ‡∏ä‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠:
- ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏£‡∏≤‡∏¢‡∏£‡∏≠‡∏ö

---

## 8.3 tbl_sps03 (‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢)
- total_*
- collect_* (‡∏¢‡∏≠‡∏î‡∏™‡∏∞‡∏™‡∏°)
- total_farmers

‡πÉ‡∏ä‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠:
- ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏£‡∏≠‡∏ö

---

# üîÅ FLOW SUMMARY

‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏® (B00)
   ‚Üì
‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà (B10)
   ‚Üì
   ‚îú‚îÄ ‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£ (EX01)
   ‚îú‚îÄ ‡∏Ç‡∏≠‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠ (C10/C102)
   ‚îú‚îÄ ‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠ (B20 ‚Üí B21/B22/B23)
   ‚îî‚îÄ ‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢ (B30 ‚Üí B31)
   ‚Üì
‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô (SPS01/02/03)

---

END OF TRANSACTION TABLES
```

---

‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå 3:

üìÑ `tables_master_preparation.md`
(‡∏£‡∏ß‡∏° Master + Preparation ‡πÅ‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏° clean ‡πÅ‡∏•‡∏∞‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á‡∏Å‡∏±‡∏ö Transaction)

‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ß‡πà‡∏≤ ‚Äú‡∏ï‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå 3‚Äù ‡πÄ‡∏î‡∏µ‡πã‡∏¢‡∏ß‡∏à‡∏±‡∏î‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏¢ üöÄ
